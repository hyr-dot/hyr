## naive birthday attack

### 寻找32bit sm3哈希值的碰撞

​	采用gmssl库中的sm3模块来生成哈希值。首先寻找32bit的碰撞，由于输出结果采用字节（4bit）编码，因此32bit即结果的前8位。根据生日攻击理论，寻找一个32bit碰撞需要大概两个$2^{16}$大小的集合。

​	如下图所示，首先生成一个$2^{16}$大小的集合A，以字典方式进行存储。其中键为哈希值的前8位，值为哈希函数的输入。集合A的生成方法是使用从0到65535的整数生成。

![image-20220729164808303](https://user-images.githubusercontent.com/57925688/181723776-98dc5b31-caf2-4002-b86f-d2e37ac3ddc9.png)

​	A的结果如下，共65535个元素：

![image-20220729164941892](https://user-images.githubusercontent.com/57925688/181723810-6a546a95-2169-482f-ba4f-489691c36503.png)

​	之后进行碰撞测试，采用65536之后的整数作为输入，依次进行碰撞测试，若找到碰撞，则输出结果；否则输入值+1，继续测试。

![image-20220729165214820](https://user-images.githubusercontent.com/57925688/181723907-be72798d-7cca-4c25-8b36-bcc39d5c6f7c.png)

​	当寻找到碰撞时，统计用时并观察结果，如下图所示：

![image-20220729165354395](https://user-images.githubusercontent.com/57925688/181723971-06dc790c-dae1-4d12-949a-237103905207.png)

​	第一行表示建立表A的时间，第二行表示找到碰撞的两个原像，第三行表示找到碰撞的时间。

​	结论：从时间和找到碰撞时的原像大小来看，找到原像时集合B大小约为$2^{16}$量级。

### 寻找48bit sm3哈希值的碰撞

仅对部分代码作出修改即可，详情可见代码文件。

最终时间为一小时二十分钟左右。

![image](https://user-images.githubusercontent.com/57925688/181746771-3350bad1-2e90-4544-a9e5-7044b59c76ec.png)

